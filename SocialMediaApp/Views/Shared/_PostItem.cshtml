@model SocialMediaApp.Models.ViewModels.FeedPostViewModel

<div class="post-card mb-4 p-3 border rounded bg-white" id="post-@Model.Id">

    <div class="d-flex justify-content-between align-items-start">

        <div>
            <strong>@Model.Title</strong>
            <div class="text-muted small">
                by @Model.UserName
            </div>
        </div>

        <div class="text-end">

            <small class="text-muted d-block">
                @Model.CreatedAt.ToLocalTime().ToString("g")
            </small>

            @if (Model.CanDelete)
            {
                <form asp-controller="Posts"
                    asp-action="Delete"
                    asp-route-id="@Model.Id"
                    method="post"
                    class="mt-1"
                    onsubmit="return confirm('Delete this post?');">

                    @Html.AntiForgeryToken()

                    <button type="submit"
                            class="btn btn-sm btn-danger text-white px-3">
                        Delete
                    </button>
                </form>
            }

        </div>
    </div>


    <div class="mt-3">
        <p>@Model.Content</p>
    </div>

    <div class="post-actions d-flex gap-3 mt-3">
        <button type="button" 
                class="btn btn-link p-0 like-button" 
                data-post-id="@Model.Id"
                data-is-liked="@Model.IsLikedByCurrentUser.ToString().ToLower()">
            <span class="like-icon">
                @if (Model.IsLikedByCurrentUser)
                {
                    <span class="text-primary">‚ù§Ô∏è</span>
                }
                else
                {
                    <span class="text-muted">ü§ç</span>
                }
            </span>
            <span class="like-count">@Model.LikesCount</span>
        </button>

        <button class="btn btn-link p-0 text-muted"
                data-bs-toggle="collapse"
                data-bs-target="#comments-@Model.Id">
            üí¨ <span class="comment-count-@Model.Id">@Model.CommentsCount</span>
        </button>
    </div>

    <div class="collapse mt-2" id="comments-@Model.Id">

        <form class="comment-form" data-post-id="@Model.Id">
            <div class="input-group">
                <input type="text" 
                       name="content"
                       class="form-control comment-input"
                       placeholder="Add a comment..." 
                       required>
                <button type="submit" class="btn btn-primary">Comment</button>
            </div>
        </form>

        <div class="comments-list mb-3" id="comments-list-@Model.Id">
            @if (Model.Comments.Any())
            {
                foreach (var comment in Model.Comments)
                {
                    <div class="comment border-bottom py-2">
                        <span class="fw-bold">@comment.UserName</span>
                        <small class="text-muted ms-2">
                            @comment.CreatedAt.ToLocalTime().ToString("g")
                        </small>
                        <div>@comment.Content</div>
                    </div>
                }
            }
            else
            {
                <p class="text-muted small no-comments-message">No comments yet. Be the first to comment!</p>
            }
        </div>
    </div>

</div>